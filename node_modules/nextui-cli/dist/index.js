#!/usr/bin/env node
import v from 'chalk';
import { Command } from 'commander';
import Pt from 'gradient-string';
import cr, { existsSync, readFileSync, mkdirSync, writeFileSync, renameSync } from 'node:fs';
import { exec, execSync } from 'node:child_process';
import so from 'async-retry';
import { compareVersions } from 'compare-versions';
import po, { oraPromise } from 'ora';
import { fileURLToPath } from 'node:url';
import Fo, { resolve, join, basename } from 'pathe';
import wo from 'fast-glob';
import * as F from '@clack/prompts';
import { spinner, text, select, cancel, isCancel } from '@clack/prompts';
import { findUp } from 'find-up';
import ft from '@winches/prompts';
import { Readable } from 'node:stream';
import { pipeline } from 'node:stream/promises';
import Go from 'tar';

var It=["#F54180","#338EF7"],Ze=Pt(...It),eo=Ze("NextUI CLI:"),s=class{constructor(){}static log(...t){console.log(...t);}static info(...t){console.info(...t.map(n=>v.blue(n)));}static success(...t){console.info(...t.map(n=>v.green(n)));}static warn(...t){console.warn(...t.map(n=>v.yellow(n)));}static error(...t){console.error(...t.map(n=>v.red(n)));}static grey(...t){console.log(...t.map(n=>v.gray(n)));}static gradient(t,n){this.log(Pt(...n?.colors??It)(String(t)));}static prefix(t,...n){return this[t](eo,...n)}static newLine(t){t||(t=1);for(let n=0;n<t;n++)this.log();}};function to(e,t){let n=0,o=e.length,r=t.length,i=0,a=0;for(;i<o&&a<r;)e[i]===t[a]&&(n++,a++),i++;return n}function Pe(e,t){let n=0,o="";for(let r of e){let i=to(r,t);i>n&&(n=i,o=r);}return o!==""?o:null}function et(e,t){let n=Pe(e,t);n?s.error(`Unknown option '${t}', Did you mean '${n}'?`):s.error(`Unknown option '${t}'`),process.exit(1);}var tt={bold:{bottomLeft:"\u2517",bottomRight:"\u251B",horizontal:"\u2501",topLeft:"\u250F",topRight:"\u2513",vertical:"\u2503"},classic:{bottomLeft:"+",bottomRight:"+",horizontal:"-",topLeft:"+",topRight:"+",vertical:"|"},double:{bottomLeft:"\u255A",bottomRight:"\u255D",horizontal:"\u2550",topLeft:"\u2554",topRight:"\u2557",vertical:"\u2551"},doubleSingle:{bottomLeft:"\u2558",bottomRight:"\u255B",horizontal:"\u2550",topLeft:"\u2552",topRight:"\u2555",vertical:"\u2502"},round:{bottomLeft:"\u2570",bottomRight:"\u256F",horizontal:"\u2500",topLeft:"\u256D",topRight:"\u256E",vertical:"\u2502"},single:{bottomLeft:"\u2514",bottomRight:"\u2518",horizontal:"\u2500",topLeft:"\u250C",topRight:"\u2510",vertical:"\u2502"},singleDouble:{bottomLeft:"\u2559",bottomRight:"\u255C",horizontal:"\u2500",topLeft:"\u2553",topRight:"\u2556",vertical:"\u2551"}};var V=process.cwd(),I=e=>resolve(V,e),Ie=resolve(fileURLToPath(import.meta.url),"../components.json");function E(e="",t=""){try{return compareVersions(e,t)}catch{return 0}}async function lo(){if(!existsSync(Ie)){await $t();return}let e=JSON.parse(readFileSync(Ie,"utf-8")),t=e.version,n=e.betaVersion,o=await G("latestVersion"),r=await G("betaVersion");(E(t,o)===-1||E(n,r)===-1)&&await $t(o,r);}async function nt(){let e={};await lo();try{e=JSON.parse(readFileSync(Ie,"utf-8"));}catch(t){}return e}async function ot(e,t){t=t??`Executing ${e}`;let n=po({discardStdin:!1,spinner:{frames:[`\u280B ${v.gray(`${t}.`)}`,`\u2819 ${v.gray(`${t}..`)}`,`\u2839 ${v.gray(`${t}...`)}`,`\u2838 ${v.gray(`${t}.`)}`,`\u283C ${v.gray(`${t}..`)}`,`\u2834 ${v.gray(`${t}...`)}`,`\u2826 ${v.gray(`${t}.`)}`,`\u2827 ${v.gray(`${t}..`)}`,`\u2807 ${v.gray(`${t}...`)}`,`\u280F ${v.gray(`${t}.`)}`],interval:150}});n.start();let o=await new Promise(r=>{exec(e,(i,a)=>{i&&(s.error(`Exec cmd ${e} error`),process.exit(1)),r(a.trim());});});return n.stop(),o}async function B(e){return x.nextUIComponentsPackageMap[e]?x.nextUIComponentsPackageMap[e].version:(await Nt(e)).version}var vt=e=>`https://unpkg.com/@nextui-org/react@${e}/dist/components.json`;async function $t(e,t){[e,t]=await Promise.all([e||G("latestVersion"),t||G("betaVersion")]);let n=vt(e),[o,r]=await Promise.all([St(n),L("beta")?St(vt(t),!1):Promise.resolve([])]),i=r.filter(p=>!o.find(m=>m.name===p.name));o.push(...i);let a={betaComponents:r,betaVersion:t,components:o,version:e};return writeFileSync(Ie,JSON.stringify(a,null,2),"utf-8"),a}async function St(e,t=!0){let n;return await oraPromise(so(async o=>{try{let r=await fetch(e,{body:null,headers:{"Content-Type":"application/json",accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7"},method:"GET",mode:"cors"});n=JSON.parse(await r.text());}catch(r){o(r);}},{retries:3}),{failText(o){t&&s.prefix("error",`Update components data error: ${o}`),process.exit(1);},...t?{successText:v.greenBright(`Components data updated successfully!
`)}:{},text:"Fetching components data..."}),n}process.env.CI==="true";var Et=resolve(fileURLToPath(import.meta.url),"../.."),rt=e=>resolve(Et,e),Lt=resolve(fileURLToPath(import.meta.url),".."),uo=existsSync(join(Lt,"components.json")),Me=uo?resolve(`${Lt}/.nextui-cli-cache`):resolve(join(Et,".."),"node_modules/.nextui-cli-cache"),Re=resolve(`${Me}/data.json`);var xo=30*6e4,it=!1;function st(e=it){it=!!e,!existsSync(Me)&&(mkdirSync(Me,{recursive:!0}),writeFileSync(Re,JSON.stringify({}),"utf8"));}function Oe(){let e=readFileSync(Re,"utf8");return JSON.parse(e)}function Rt(e,t,n){st();let o=n??Oe(),r=new Date,i=+r+xo;o[e]={...t,date:r,expiredDate:i,expiredFormatDate:new Date(i).toString(),formatDate:r.toString()},writeFileSync(Re,JSON.stringify(o,void 0,2),"utf-8");}function yo(){return +new Date}function Co(e){return yo()-e}function Ot(e,t){if(it)return !0;let o=(t??Oe())[e];return o?.expiredDate?Co(o.expiredDate)>0:!0}async function Nt(e){let t=Oe();if(Ot(e,t)){let r={version:await ot(`npm view ${e} version`,`Fetching ${e} latest version`)};return Rt(e,r,t),r}return t[e]}async function z(e,t){let n=Oe();if(Ot(e,n)){let i={execResult:await ot(e,t)};return Rt(e,i,n),i.execResult}return n[e].execResult}async function _e(e){return await z(`npm view ${e} dist-tags --json`,`Fetching ${e} tags`)}function _t(e){return `@nextui-org/${e.replace("@nextui-org/","")}`}async function Ae(e){if(x.betaNextUIComponentsPackageMap[e])return x.betaNextUIComponentsPackageMap[e].version;let t=await _e(e);try{return JSON.parse(t).beta}catch(n){s.error(`Get beta version error: ${n}`),process.exit(1);}}async function Vt(e){return await Promise.all(e.map(_t).map(async n=>{let o=await Ae(n);return `${_t(n)}@${o}`}))}var Ve=/([\^~])/;function qt(e,t){return s.gradient(e),t}function Yt(e){return e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join("")}var re=(e,t)=>wo.sync(e,{absolute:!0,cwd:V,deep:5,ignore:["node_modules/**","dist/**","build/**","coverage/**","public/**","out/**"],onlyFiles:!0,...t});function qe(e){return e==="false"?!1:!!e}function Kt(e,t){return Object.fromEntries(Object.entries(e).filter(([n])=>!t.includes(n)))}function ie(e,t){return e=X(e),t=X(t),je(e,t)?je(e,t):Fe(e,t)?Fe(e,t):Ft(e,t)?Ft(e,t):t}function je(e,t){let n=e.split("."),o=t.split(".");return n[0]!==o[0]?v.redBright(o.join(".")):""}function Fe(e,t){let n=e.split("."),o=t.split(".");return n[1]!==o[1]?`${v.white(o[0])}${v.white(".")}${v.cyanBright(o.slice(1).join("."))}`:""}function Ft(e,t){let n=e.split("."),o=t.split(".");return n[2]!==o[2]?`${v.white(o.slice(0,2).join("."))}${v.white(".")}${v.greenBright(o.slice(2).join("."))}`:""}function se(e,t){let n=e[t].replace(Ve,""),o=e[t].match(Ve)?.[1]||"";return {currentVersion:n,versionMode:o}}function ge(e){return {bun:{install:"add",remove:"remove",run:"run"},npm:{install:"install",remove:"uninstall",run:"run"},pnpm:{install:"add",remove:"remove",run:"run"},yarn:{install:"add",remove:"remove",run:"run"}}[e]}function X(e,t=!1){return e.split("||").map(r=>r.trim()).map(r=>r.replace(/^[<=>^~]+\s*/,"").trim()).sort((r,i)=>t?compareVersions(i,r):compareVersions(r,i))[0]}function Q(e,t){let n=e.replace(M,""),o=t-n.length>0?" ".repeat(t-n.length):"";return `${e}${o}`}function D(e){return e.replace(M,"")}function A(e,t=!0){let n;try{n=JSON.parse(readFileSync(e,"utf-8"));}catch(c){s.prefix("error",`Error reading package.json file: ${e} 
Error: ${c}`);}let o=n.devDependencies||{},r=n.dependencies||{},i={...o,...r},a=new Set(Object.keys(i)),p=x.nextUIComponents.map(c=>{let u=c.version,y=c.versionMode;if(a.has(c.package)){let f=se(i,c.package);u=t?`${f.currentVersion} new: ${u}`:f.currentVersion,y=f.versionMode;}return {...c,version:u,versionMode:y}}).filter(c=>a.has(c.package)),m=a.has(b);return {allDependencies:i,allDependenciesKeys:a,currentComponents:p,dependencies:r,devDependencies:o,isAllComponents:m,packageJson:n}}function Bt(e){return e.map(t=>{let o=x.nextUIComponentsMap[t]?.package;return o||t})}async function zt(e,t,n=!0){let o=[];for(let r of e){let{currentVersion:i}=se(t,r),{versionMode:a}=se(t,r),p=(await z(`npm show ${r} homepage`)||"").replace(/\n/,""),m=(await z(`npm show ${r} description`)||"").replace(/\n/,""),c=x.nextUIComponentsPackageMap[r]?.version||await B(r);i=n?`${i} new: ${c}`:i;let u={description:m||"",docs:p||"",name:r,package:r,peerDependencies:{},status:"stable",style:"",version:i,versionMode:a};o.push(u);}return o}var Jt="nextui-cli",ve="framer-motion",$e="tailwindcss",b="@nextui-org/react",q="@nextui-org/theme",Z="@nextui-org/system";var at="https://nextui.org/docs/guide/installation#global-installation",Ye="https://nextui.org/docs/guide/installation#tailwind-css-setup";var Ht="https://nextui.org/docs/guide/installation#setup-pnpm-optional",Ke="https://nextui.org/docs/guide/installation#provider-setup",S={checkPluginsRegex:/nextui(([\W\w]+)?)/,content:"./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",darkMode:'darkMode: "class"',importContent:(e=!1)=>e?"import {nextui} from '@nextui-org/theme';":"const {nextui} = require('@nextui-org/theme');",plugins:"nextui()"},Be={content:(e,t)=>{e.forEach(r=>{let i=Wt(r,t);e.push(...i);});let n=[...new Set(e.map(r=>r.style||r.name))];return n.length===1?`./node_modules/@nextui-org/theme/dist/components/${n[0]}.js`:`./node_modules/@nextui-org/theme/dist/components/(${n.reduce((r,i)=>r+=`${i}|`,"").replace(/\|$/,"")}).js`},plugins:"nextui()"},pt={import:"NextUIProvider"},R={content:"public-hoist-pattern[]=*@nextui-org/*"};function Wt(e,t){let n=e.name,o=I(`node_modules/@nextui-org/${n}`),r=[e];if(!existsSync(o)&&t){let a=I("node_modules/.pnpm"),p=wo.sync(`**/@nextui-org/${n}`,{absolute:!0,cwd:a,onlyDirectories:!0})[0];if(p)o=p;else return r}let{currentComponents:i}=A(join(o,"package.json"));if(i.length)for(let a of i){let p=Wt(a,t);r.push(...p);}return r}var x={debug:!1,beta:!1,cliLatestVersion:"",latestVersion:"",betaVersion:"",betaNextUIComponents:[],betaNextUIComponentsKeys:[],betaNextUIComponentsKeysSet:new Set,betaNextUIComponentsMap:{},betaNextUIComponentsPackageMap:{},betaNextUIcomponentsPackages:[],nextUIComponents:[],nextUIComponentsKeys:[],nextUIComponentsKeysSet:new Set,nextUIComponentsMap:{},nextUIComponentsPackageMap:{},nextUIcomponentsPackages:[]};async function G(e){let t=x[e];return t||(e==="latestVersion"?(t=await B(b),x[e]=t):e==="cliLatestVersion"?(t=await B(Jt),x[e]=t):e==="betaVersion"&&(t=await Ae(b),x[e]=t)),t}function L(e){return x[e]}function Ao(e){let t=e.map(a=>a.name),n=e.map(a=>a.package),o=new Set(t),r=e.reduce((a,p)=>(a[p.name]=p,a),{}),i=e.reduce((a,p)=>(a[p.package]=p,a),{});return {nextUIComponentsKeys:t,nextUIComponentsKeysSet:o,nextUIComponentsMap:r,nextUIComponentsPackageMap:i,nextUIcomponentsPackages:n}}function ct({beta:e,nextUIComponents:t}){let{nextUIComponentsKeys:n,nextUIComponentsKeysSet:o,nextUIComponentsMap:r,nextUIComponentsPackageMap:i,nextUIcomponentsPackages:a}=Ao(t);e?(x.betaNextUIComponents=t,x.betaNextUIComponentsKeys=n,x.betaNextUIComponentsKeysSet=o,x.betaNextUIComponentsMap=r,x.betaNextUIComponentsPackageMap=i,x.betaNextUIcomponentsPackages=a):(x.nextUIComponents=t,x.nextUIComponentsKeys=n,x.nextUIComponentsKeysSet=o,x.nextUIComponentsMap=r,x.nextUIComponentsPackageMap=i,x.nextUIcomponentsPackages=a);}var ze=["package","version","status","docs"],Gt=["package","version","status"];var M=/\u001b\[[\d;]+m/g,N=tt.round,lt="   ",Se=`${N.vertical}${lt}`,Xt=`${lt}${N.vertical}${lt}`,Qt=/([\W\w]+)\snew:/,Zt=/new:\s([\W\w]+)/;function ae({commandName:e,components:t,message:n=`Current installed components:
`,warnError:o=!0}){if(!t.length){o&&s.prefix("warn","No components found");return}let r={description:0,docs:0,name:0,originVersion:0,package:0,peerDependencies:0,status:0,style:0,version:0};for(let u of t)for(let y in u){let f=String(u[y]);if(y==="version"){let l=f.match(Zt)?.[1],g=f.match(Qt)?.[1],w=D(en(g,l));r[y]=Math.max(r[y],Math.max(w.length,7)),r.originVersion=Math.max(r.originVersion,g.length);continue}r[y]=Math.max(r[y],f.length);}let i=t.reduce((u,y)=>{let f=Se;for(let l of ze){let g=Q(y[l],r[l]);if(e!=="list"&&l==="version"){let w=g.match(Qt)?.[1]?.trim(),C=g.match(Zt)?.[1]?.trim();w===C?(g=g.replace(/\snew:\s[\W\w]+(\s+)?/,""),g=Q(`${Q(g,r.originVersion)} \u{1F680}latest`,r[l]),g=g.replace("latest",v.magentaBright.underline("latest"))):C&&(g=Q(en(Q(w,r.originVersion),C),r[l]));}y.status==="stable"&&Gt.includes(l)?g=v.greenBright(g):y.status==="new"?g=v.magentaBright(g):y.status==="updated"&&(g=v.blueBright(g)),f+=g+Xt;}return u.push(f),u},[]),a=N.topLeft+Se.replace(/.*/g,N.horizontal).slice(1),p=Se,m=N.vertical+Se.replace(/.*/g,N.horizontal).slice(1);for(let u of ze)a+=`${N.horizontal.padEnd(r[u]+7,N.horizontal)}`,p+=v.redBright(Yt(u).padEnd(r[u]))+Xt,m+=`${N.horizontal.padEnd(r[u]+7,N.horizontal)}`;a=a.slice(0,-2)+N.topRight,m=m.slice(0,-2)+N.vertical;let c=N.bottomLeft+Se.replace(/.*/g,N.horizontal).slice(1);for(let u of ze)c+=`${N.horizontal.padEnd(r[u]+7,N.horizontal)}`;c=c.slice(0,-2)+N.bottomRight,i=[a,p,m,...i,c],s.info(n),s.log(i.join(`
`));}function tn(){s.newLine(),s.log(v.redBright("Environment Info:")),s.log(v.blueBright("  System:")),s.log(v.blueBright("    OS:"),process.platform),s.log(v.blueBright("    CPU:"),process.arch),s.log(v.greenBright("  Binaries:")),s.log(v.greenBright("    Node:"),process.version),s.newLine();}function fe({align:e="center",borderStyle:t="round",center:n=!1,color:o,log:r=!0,padding:i=0,text:a,title:p}){let m=tt[t],c=o?Object.fromEntries(Object.entries(m).map(([U,T])=>[U,v[o](T)])):m,u=a.split(`
`),y=u.map(U=>U.replace(M,"")),f=i>0,l=i,g=n||f,w=y.reduce((U,T)=>T.length>U?T.length:U,0);w=f?w+l*4:w;let C=p?p.replace(M,""):"",d=p?C.length:0,P=w-d,h=2;for(;d+h+l>=w;)w+=Math.floor(d/2);P=w-d;let k=(()=>{if(p)if(e==="center"){let U=Math.floor(P/2)-1,T=Math.ceil(P/2)-1,Qe=U>0?c.horizontal.repeat(U):"",W=T>0?c.horizontal.repeat(T):"";return `${Qe} ${p} ${W}`}else return e==="left"?` ${p} ${c.horizontal.repeat(P-2)}`:`${c.horizontal.repeat(P-2)} ${p} `;return c.horizontal.repeat(w)})(),$=c.topLeft+k+c.topRight,_=c.bottomLeft+c.horizontal.repeat(w)+c.bottomRight,H=u.reduce((U,T)=>{let Qe=T.replace(M,""),W=w-Qe.length,Gn=" ".repeat(W),kt=Math.floor(W/2),bt=Math.ceil(W/2),Xn=kt>0?" ".repeat(kt):"",Qn=bt>0?" ".repeat(bt):"";if(n)U.push(`${c.vertical}${W?`${Xn}${T}${Qn}`:T}${c.vertical}`);else if(i){let Zn=W-l*2;U.push(`${c.vertical}${" ".repeat(l*2)}${T}${" ".repeat(Zn)}${c.vertical}`);}else U.push(`${c.vertical}${W>0?`${T}${Gn}`:T}${c.vertical}`);return U},[]);if(g)for(let U=0;U<l;U++)H.unshift(`${c.vertical}${" ".repeat(w)}${c.vertical}`),H.push(`${c.vertical}${" ".repeat(w)}${c.vertical}`);return H=[$,...H,_],r&&s.log(H.join(`
`)),H.join(`
`)}function en(e,t){return `${v.white(`${e} ->`)} ${v.yellowBright(`${t} (new)`)}`}function nn(){fe({color:"yellow",padding:1,text:`NextUI has rebranded to HeroUI! These packages are deprecated and won\u2019t receive updates.
HeroUI offers the same great features with ongoing improvements.

\u2192 ${v.bold("Switch to [HeroUI](https://heroui.com) for the latest updates.")}
\u2192 ${v.bold("Migration guide:")} [NextUI to HeroUI](https://heroui.com/docs/nextui-to-heroui)
\u2192 ${v.bold("New NPM package:")} "@heroui/react"

Thanks for your support \u2014 see you at HeroUI!`,title:v.yellow(`\u2757\uFE0F Notice: NextUI is now ${v.bold("HeroUI")} \u2757\uFE0F`)});}var Je={name:"nextui-cli",private:!1,type:"module",license:"MIT",version:"0.5.2",homepage:"https://github.com/nextui-org/nextui-cli#readme",description:"A CLI tool that unlocks seamless NextUI integration",keywords:["UI","CLI","Tool","NextUI","Template","Integration","Add Component"],author:{name:"NextUI",email:"support@nextui.org",url:"https://github.com/nextui-org"},repository:{type:"git",url:"https://github.com/nextui-org/nextui-cli.git"},bugs:{url:"https://github.com/nextui-org/nextui-cli/issues"},publishConfig:{access:"public",registry:"https://registry.npmjs.org/"},files:["dist"],bin:{nextui:"./dist/index.js"},main:"./dist/index.js",module:"./dist/index.js",types:"./dist/index.d.ts",scripts:{dev:"tsup --watch","link:cli":"pnpm link --global","link:remove":"pnpm uninstall --global nextui-cli",build:"tsup","update:components":"tsx src/scripts/update/update-components.ts","sync:docs":"tsx src/scripts/sync/sync.ts","clean:cache":"tsx src/scripts/cache/clean.ts",lint:"eslint . --max-warnings=0","lint:fix":"eslint . --max-warnings=0 --fix","check:prettier":"prettier --check .","check:types":"tsc --noEmit",changelog:"npx conventional-changelog -p angular -i CHANGELOG.md -s --commit-path .",release:"bumpp --execute='pnpm run changelog' --all",prepare:"husky install",postbuild:"pnpm run update:components",prepublishOnly:"pnpm run build"},dependencies:{"@clack/prompts":"0.7.0","@winches/prompts":"0.0.6","async-retry":"1.3.3",chalk:"5.3.0",commander:"11.0.0","compare-versions":"6.1.1","fast-glob":"3.3.2","find-up":"7.0.0","gradient-string":"2.0.2",ora:"8.0.1",pathe:"1.1.2",tar:"6.2.1"},devDependencies:{"@commitlint/cli":"17.7.1","@commitlint/config-conventional":"17.7.0","@types/gradient-string":"1.1.3","@types/node":"20.11.30","@typescript-eslint/eslint-plugin":"6.7.2","@typescript-eslint/parser":"6.7.2",bumpp:"9.4.0","clean-package":"2.2.0","commitlint-plugin-function-rules":"2.0.2","conventional-changelog-cli":"4.1.0",eslint:"8.50.0","eslint-config-prettier":"9.0.0","eslint-import-resolver-typescript":"3.6.1","eslint-plugin-import":"2.28.1","eslint-plugin-prettier":"5.0.0","eslint-plugin-sort-destructure-keys":"1.5.0","eslint-plugin-sort-keys-fix":"1.1.2","eslint-plugin-unicorn":"52.0.0","eslint-plugin-unused-imports":"3.0.0",husky:"8.0.3","lint-staged":"14.0.1",prettier:"3.3.2",tsup:"7.2.0",tsx:"4.7.1",typescript:"5.2.2"},engines:{pnpm:">=9.x"},packageManager:"pnpm@9.6.0"};function on(e){let t=/import {?\s*([\W\w]+?)\s*}? from ["'](.+)["']/g,n=e.match(t)??[],o=[];for(let i of n)o.push(r(i));return o.length?o:[];function r(i){let a=/import {?\s*([\W\w]+?)\s*}? from ["'](.+)["']/,p=i.match(a)??[];return [p[1]??"",p[2]??""]}}function rn(e){return e.replace(/^["'`](.*)["'`]$/,"$1")}function Y(e,t){let n=new RegExp(`\\s*${e}:\\s\\[([\\w\\W]*?)\\]\\s*`);return n.test(t)?t.match(n)?.[1]?.split(/,\s/g).map(o=>rn(o.trim())).filter(Boolean)??[]:[]}function de(e,t,n,o){let r=new RegExp(`\\s*${e}:\\s\\[([\\w\\W]*?)\\]\\s*`),i=o??n.map(u=>JSON.stringify(u)).join(", ");if(r.test(t)){let u=e==="content"?`
  ${e}: [${i}]`:`
  ${e}: [${n}]`;return t.replace(r,u)}let a=t.split(`
`),p=a.findIndex(u=>u.includes("content:")),m=a.findIndex(u=>u.includes("module.exports =")),c=p!==-1?p-1:m!==-1?m:0;return e==="content"?a.splice(c+1,0,`  ${e}: [${i}],`):a.splice(c+1,0,`  ${e}: [${n.map(u=>rn(u))}],`),a.join(`
`)}var he="".padEnd(7),an="Missing";async function pn(e){let{all:t,allDependencies:n,isNextUIAll:o,upgradeOptionList:r}=e,i=[],a=new Set,p=await So(t,o,n,a),m=r.map(l=>({...l,latestVersion:ie(l.version,l.latestVersion)})),c=await Promise.all(r.map(l=>Ue(l.package,n,a,l.peerDependencies))),u=await Uo([...a]),y=[...m,...p.allOutputList],f=[...c.flat(),...p.allPeerDepList,...u].filter((l,g,w)=>g===w.findIndex(C=>C.package===l.package));return $o(y,f),i=[...y,...f].filter((l,g,w)=>!l.isLatest&&g===w.findIndex(C=>C.package===l.package)),No(i),i}function sn(e,t=!1){if(!e.length)return "";let n=[],o={latestVersion:0,package:0,version:0};for(let r of e)for(let i in r){if(!Object.prototype.hasOwnProperty.call(r,i)||!r[i])continue;i==="version"&&(r[i]=r[i].replace(Ve,""));let a=i==="version"?r[i].replace(M,"").length:r[i].length;o[i]=Math.max(o[i],a);}for(let r of e){if(r.isLatest){if(t)continue;n.push(`  ${v.white(`${`${r.package}@${r.versionMode||""}${r.latestVersion}`.padEnd(o.package+he.length+he.length)}`)}${v.greenBright("latest").padStart(o.version)}${he}`);continue}n.push(`  ${v.white(`${r.package.padEnd(o.package+he.length)}${he}${Q(`${r.versionMode||""}${r.version}`,o.version)}  ->  ${r.versionMode||""}${r.latestVersion}`)}${he}`);}return n.join(`
`)}async function Ue(e,t,n,o){if(o=o||JSON.parse(await z(`npm show ${e} peerDependencies --json`))||{},!o||!Object.keys(o).length)return [];let r=[];for(let[i,a]of Object.entries(o)){if(r.some(y=>y.package===i))continue;let p=t[i],m=X(a);if(!p){n.add({name:i,version:m});continue}let{versionMode:c}=se(t,i),u=E(p,m)>=0;u?m=X(p):m=await B(i),r.push({isLatest:u,latestVersion:u?m:ie(p,m),package:i,version:p,versionMode:c});}return r}function $o(e,t){let n=e.length===1?"Component":"Components",o={components:{color:"blue",text:"",title:v.blue(n)},peerDependencies:{color:"yellow",text:"",title:v.yellow("PeerDependencies")}},r=sn(e),i=sn(t,!0),a=t.filter(p=>!p.isLatest);r.length&&fe({...o.components,text:r}),s.newLine(),a.length&&s.log(v.gray(`Required min version: ${a.map(p=>`${p.package}>=${p.latestVersion.replace(M,"")}`).join(", ")}`)),i.length&&fe({...o.peerDependencies,text:i});}async function So(e,t,n,o){if(!e||!t)return {allOutputList:[],allPeerDepList:[]};let r=x.latestVersion,{currentVersion:i,versionMode:a}=se(n,b),p=ie(i,r),m=E(i,r)>=0,c=await Ue(b,n,o),u=await Ue(q,n,o),y=[{isLatest:m,latestVersion:p,package:b,version:i,versionMode:a}],f=[...c,...u];return {allOutputList:y,allPeerDepList:f}}async function Uo(e){let t=[];for(let n of e){let o={isLatest:!1,latestVersion:n.version,package:n.name,version:v.red(an),versionMode:""};t.push(o);}return t}function No(e){let t={major:0,minor:0,patch:0};for(let o of e){if(o.version===an){t.major++;continue}let r=D(o.latestVersion);je(o.version,r)?t.major++:Fe(o.version,r)?t.minor++:t.patch++;}let n=Object.entries(t).reduce((o,[r,i])=>i?`${o}${v.yellowBright(i)} ${r}, `:o,"").replace(/, $/,"");return n&&(s.log(n),s.newLine()),t}function cn({dependencies:e,devDependencies:t,upgradePackageList:n}){for(let o of n){let r=D(o.latestVersion);if(t[o.package]){t[o.package]=r;continue}e[o.package]=r;}}function pe(e,t){let{errorInfo:n,missingDependencies:o,tailwindName:r}=t;return e==="missingDependencies"?{level:"error",name:"missingDependencies",outputFn:()=>{s.log("You have not installed the required dependencies"),s.newLine(),s.log("The required dependencies are:"),o.forEach(i=>{s.log(`- ${i}`);}),s.newLine(),s.log(`See more info here: ${v.underline(at)}`);}}:e==="incorrectTailwind"?{level:"error",name:"incorrectTailwind",outputFn:()=>{s.log(`Your ${r} is incorrect`),s.newLine(),s.log("The missing part is:"),n.forEach(i=>{s.log(`- need to add ${i}`);}),s.newLine(),s.log(`See more info here: ${v.underline(`${Ye}-1`)}`);}}:{level:"error",name:"incorrectApp",outputFn:()=>{s.log("Your App.tsx is incorrect"),s.newLine(),s.log("The missing part is:"),n.forEach(i=>{s.log(`- need to add ${i}`);}),s.newLine(),s.log(`See more info here: ${v.underline(at)}`);}}}async function ce(e,t,n){let o=[],{allDependencies:r,beta:i,packageNames:a,peerDependencies:p}=n??{},m=[];if(p){let c=await To({allDependencies:r,packageNames:a});m.push(...c);}if(e==="all"){let c=t.has(b),u=t.has(ve),y=t.has($e);if(c&&u&&!m.length)return [!0];!c&&o.push(i?`${b}@${x.betaVersion}`:b),!u&&o.push(ve),!y&&o.push($e);}else if(e==="partial"){let c=t.has(ve),u=t.has($e),y=t.has(Z),f=t.has(q);if(c&&y&&f&&!m.length)return [!0];!c&&o.push(ve);let l=await _e(Z),g=await _e(q);!y&&o.push(i?`${Z}@${l}`:Z),!f&&o.push(i?`${q}@${g}`:q),!u&&o.push($e);}return [!1,...o,...p?m:[]]}async function To(e){let{allDependencies:t,packageNames:n}=e,o=[];for(let r of n){let i=await Ue(r,t,new Set);for(let a of i)if(!a.isLatest){let p=o.findIndex(u=>u.includes(a.package)),c=D(o[p]||"")?.match(/@([\d.]+)/)?.[1];c&&E(c,D(a.latestVersion))<=0&&o.splice(p,1),o.push(`${a.package}@${a.latestVersion}`);}}return o}function le(e,t,n,o,r,i){if(e==="partial"&&!n.length)return [!0];let a=[],p=r??readFileSync(t,"utf-8"),m=Y("content",p),c=Y("plugins",p);if(e==="all"){let y=Y("darkMode",p).some(g=>g.includes("class"))||/darkMode:\s*["'`]class/.test(p),f=m.some(g=>g.includes(S.content)),l=c.some(g=>S.checkPluginsRegex.test(g));if(y&&f&&l)return [!0];!y&&a.push(S.darkMode),!f&&a.push(S.content),!l&&a.push(S.plugins);}else if(e==="partial"){let u=Be.content(n,o),y=!1,f=m.some(g=>g.includes(S.content)?(y=!0,!0):g.includes(u));i&&y&&s.log(`
${v.yellow("Attention")} Individual components from NextUI do not require the "${v.bold(S.content)}" in the tailwind config
For optimized bundle sizes, consider using "${v.bold(u)}" instead`);let l=c.some(g=>S.checkPluginsRegex.test(g));if(f&&l)return [!0];!f&&a.push(u),!l&&a.push(S.plugins);}return [!1,...a]}function Ne(e,t){let n=[];if(e==="all"||e==="partial"){let o=readFileSync(t,"utf-8"),i=on(o).some(([a])=>a.includes(pt.import));if(i)return [!0];!i&&n.push(pt.import);}return [!1,...n]}function xe(e){let t=[],n;if(e){try{n=readFileSync(e,"utf-8");let o=n.includes(R.content);if(o)return [!0];!o&&t.push(R.content);}catch(o){t.push(`Error reading .npmrc file: ${e} 
Error: ${o}`);}return [!1,...t]}return [!1,...t]}async function ye(e=[],t=!0){let n=[];for(let o of e)if(!x.nextUIComponentsKeysSet.has(o)){let r=Pe(x.nextUIComponentsKeys,o);n.push([o,r]);}if(n.length){let[o,r]=n.reduce((i,[a,p])=>[i[0]+v.underline(a)+", ",i[1]+(p?v.underline(p)+", ":"")],["",""]);return t&&s.prefix("error",`Illegal components: ${o.replace(/, $/,"")}${r?`
${"".padEnd(12)}It may be a typo, did you mean ${r.replace(/, $/,"")}?`:""}`),!1}return !0}var ut=new Map;async function ne(e,t){return new Promise((n,o)=>{try{let{cache:r=!0,logCmd:i=!0}=t||{};ut.has(e)&&r&&n(ut.get(e)),i&&(s.newLine(),s.log(`${e}`));let a=execSync(e,{stdio:"inherit",...t?Kt(t,["logCmd"]):{}});if(a){let p=a.toString();n(p),ut.set(e,p);}n("");}catch(r){o(r);}})}var un=e=>{isCancel(e)&&(cancel(`${v.red("\u2716")} Operation cancelled`),process.exit(0));},gn=async e=>{let t=await text(e);return un(t),t},Te=async e=>{let t=await select(e);return un(t),t},ln=spinner(),fn=async e=>{let{failText:t,successText:n,task:o,text:r}=e,i=null;try{ln.start(r),i=await(o instanceof Promise?o:Promise.resolve(o)),ln.stop(n);}catch{cancel(t??i??"Task failed"),process.exit(0);}return i};async function He(e){try{await e();}catch(t){t&&(await Te({message:`${v.red("Error: ")}a unexpected error occurred, run "pnpm install" maybe can fix it or report it as a bug`,options:[{label:"Re-run pnpm install",value:"re-run-pnpm-install"},{label:"Exit",value:"exit"}]})==="exit"&&process.exit(1),await ne("pnpm install --force"),await e());}}async function gt(e,t=[]){if(L("debug"))for(let n of t)s.warn(`Debug: ${n}`);else await He(()=>ne(e));}function hn(e,t){if(!e.length||!L("debug"))return;let{dependencies:n,packageJson:o}=A(t);for(let r of e){let i=x.nextUIComponentsMap[r];i&&(n[i.package]=`${i.package}@${i.version}`);}writeFileSync(t,JSON.stringify({...o,dependencies:n},null,2),"utf-8");}function xn(e,t){if(!e.length||!L("debug"))return;let{dependencies:n,packageJson:o}=A(t);for(let r of e){let i=x.nextUIComponentsMap[r];i&&delete n[i.package];}writeFileSync(t,JSON.stringify({...o,dependencies:n},null,2),"utf-8");}var dt={onCancel:()=>{s.log(`${v.red("\u2716")} Operation cancelled`),process.exit(0);}};async function Ce(e,t){return (await ft({hint:"- Space to select. Return to submit",message:e,min:1,name:"value",type:"autocompleteMultiselect",...t?{choices:t}:{}},dt)).value}async function me(e,t){return (await ft({message:e,name:"value",type:"select",...t?{choices:t}:{}},dt)).value}async function yn(e,t){return (await ft({hint:"- Space to select. Return to submit",message:e,min:1,name:"value",type:"multiselect",...t?{choices:t}:{}},dt)).value}var We=["npm","bun","pnpm","yarn"];var Cn={"bun.lockb":"bun","npm-shrinkwrap.json":"npm","package-lock.json":"npm","pnpm-lock.yaml":"pnpm","yarn.lock":"yarn"};async function J(e=V){let t,n=await findUp(Object.keys(Cn),{cwd:e});return n?t=Cn[Fo.basename(n)]:t=await me("No agent found, please choose one",We.map(o=>({title:o,value:o}))),t}function wn(e,t){let{format:n=!1,write:o=!0}=t,r=readFileSync(e,"utf-8");r=`import {NextUIProvider} from "@nextui-org/react";
${r}`,r=Yo(r),o&&writeFileSync(e,r,"utf-8"),n&&execSync(`npx prettier --write ${e}`,{stdio:"ignore"});}function Yo(e){let t=/return\s*\(([\S\s]*?)\);/g;return e.replace(t,(o,r)=>`return (
      <NextUIProvider>
        ${r.trim()}
      </NextUIProvider>
    );`)}function Xe(e,t){let{errorInfoList:n,format:o=!1,tailwindPath:r,write:i=!0}=t;if(!n.length)return;let a=readFileSync(r,"utf-8"),p=Y("content",a),m=Y("plugins",a);for(let c of n){let[u,y]=Ko(c);if(u==="content"){if(p.includes(S.content))continue;p=p.filter(l=>!l.includes("@nextui-org/theme/dist/")),p.push(y),a=de("content",a,p,p.map((l,g,w)=>g===0?w.length===1?`
    ${JSON.stringify(l)}
`:`
    ${JSON.stringify(l)}`:w.length-1===g?`    ${JSON.stringify(l)}
  `:`    ${JSON.stringify(l)}`).join(`,
`));}else u==="plugins"&&(m.push(y),a=de("plugins",a,m),a=`${S.importContent(r.endsWith(".ts"))}
${a}`);if(e==="all"&&u==="darkMode"){let f=a.indexOf("plugins")-1,l=S.darkMode;a=`${a.slice(0,f)} ${l},
${a.slice(f)}`;}}if(i&&writeFileSync(r,a,"utf-8"),o)try{execSync(`npx prettier --write ${r}`,{stdio:"ignore"});}catch{s.warn(`Prettier failed to format ${r}`);}}function Ko(e){return S.darkMode.includes(e)?["darkMode",e]:S.plugins.includes(e)?["plugins",e]:["content",e]}function we(e,t=!0,n=!0,o=void 0){if(!existsSync(e))t&&writeFileSync(e,R.content,"utf-8");else {let r=readFileSync(e,"utf-8");r=`${R.content}
${r}`,t&&writeFileSync(e,r,"utf-8");}if(!o){s.newLine(),s.log(`Added the required content in file: ${e}`),n&&!L("debug")&&(s.newLine(),s.log("Pnpm restructure will be run now"),execSync("pnpm install",{stdio:"inherit"}));return}o({message:`Added the required content in file: ${e}`,runInstall:n});}var kn="https://codeload.github.com/nextui-org/next-app-template/tar.gz/main",bn="https://codeload.github.com/nextui-org/next-pages-template/tar.gz/main",Pn="https://codeload.github.com/nextui-org/vite-template/tar.gz/main",In="next-app-template-main",An="next-pages-template-main",vn="vite-template-main",$n="next-app-template",Sn="next-pages-template",Un="vite-template";function Nn(e,t){return e==="all"?`// tailwind.config.js
const {nextui} = require("@nextui-org/react");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    "./node_modules/@nextui-org/theme/dist/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};`:`// tailwind.config.js
const {nextui} = require("@nextui-org/theme");

/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    ${JSON.stringify(t)},
  ],
  theme: {
    extend: {},
  },
  darkMode: "class",
  plugins: [nextui()],
};`}async function En(e,t){let{addApp:n=!1,all:o=!1,appPath:r,beta:i=!1,packagePath:a=I("package.json"),tailwindPath:p=re("**/tailwind.config.(j|t)s")[0]}=t;var{allDependencies:m,allDependenciesKeys:w,currentComponents:C}=A(a);let c=t.prettier??w.has("prettier"),u=!!m[b];if(!e.length&&!o){let h=x.nextUIComponents.filter(k=>!C.some($=>$.name===k.name));h.length||(s.success("\u2705 All components have been added"),process.exit(0)),e=await Ce("Which components would you like to add?",h.map(k=>({description:k.description,title:k.name,value:k.name})));}else o&&(e=[b]);if(!o&&!ye(e,!0))return;var{allDependenciesKeys:w,currentComponents:C}=A(a);let y=C.map(h=>h.name),f=e.filter(h=>y.includes(h)||u&&h===b);if(f.length&&!L("debug")){s.prefix("error",`\u274C You have already added the following components: ${f.map(h=>v.underline(h)).join(", ")}`);return}if(n&&!r){s.prefix("error","\u274C App.(j|t)sx file not found. Please specify the appPath if the default search path does not locate your file.  'add --appPath=yourAppPath'");return}let l=await J(),g=l==="npm"?"install":"add";if(o){let[,...h]=await ce("all",w,{allDependencies:m,beta:i,packageNames:[b],peerDependencies:!0});h=h.map(k=>D(k)),h.length&&(s.info(`Adding required dependencies: ${[...h].map(k=>v.underline(k)).join(", ")}`),await gt(`${l} ${g} ${[...h].join(" ")}`,h));}else {let h=i?await Vt(e):e.map(_=>x.nextUIComponentsMap[_].package),[,...k]=await ce("partial",w,{allDependencies:m,beta:i,packageNames:h,peerDependencies:!0}),$=[...k,...h].map(_=>D(_));s.info(`Adding required dependencies: ${[...$].map(_=>v.underline(_)).join(", ")}`),await gt(`${l} ${g} ${[...$].join(" ")}`,$);}L("debug")&&hn(e,a);var{allDependenciesKeys:w,currentComponents:C}=A(a);let d=o?"all":"partial",P=l==="pnpm";if(p){let[,...h]=le(d,p,C,P,void 0,!0);Xe(d,{errorInfoList:h,format:c,tailwindPath:p}),s.newLine(),s.log(`Tailwind CSS settings have been updated in: ${p}`);}else {let h=Be.content(C,P),k=Nn(d,h),$=I("tailwind.config.js");writeFileSync($,k,"utf-8"),s.newLine(),s.info(`Tailwind CSS configuration file created at: ${$}`);}if(n&&r&&existsSync(r)){let[h]=Ne(d,r);h||(wn(r,{format:c}),s.newLine(),s.info(`NextUIProvider successfully added to the App file at: ${r}`),s.warn("Please check the placement of NextUIProvider in the App file to ensure it's correctly integrated.'"));}if(l==="pnpm"){let h=I(".npmrc");if(!existsSync(h))writeFileSync(I(".npmrc"),R.content,"utf-8");else {let[k]=xe(h);k||we(h);}}s.newLine(),s.success("\u2705 Components added successfully"),(w.has(b)||o)&&C.length&&(s.newLine(),s.log(`${v.yellow("Attention")} Individual components from NextUI do not require the \`@nextui-org/react\` package. For optimized bundle sizes, consider using individual components.`),s.log("The redundant dependencies are:"),[...new Set(C)].forEach(h=>{s.log(`- ${h.package}`);})),s.newLine(),s.grey(`Please check the ${v.bold("NextUIProvider")} whether in the correct place (ignore if added)
See more info here: ${Ke}`),L("debug")&&xn(e,a),process.exit(0);}async function Mn(e){let{appPath:t=re("**/App.(j|t)sx")[0],checkApp:n=!1,checkPnpm:o=!0,checkTailwind:r=!0,packagePath:i=I("package.json"),tailwindPath:a=re("**/tailwind.config.(j|t)s")}=e,p=qe(n),m=qe(o),c=qe(r),u=[a].flat(),{allDependencies:y,allDependenciesKeys:f,currentComponents:l,isAllComponents:g}=A(i);if(!l.length&&!g){s.prefix("error",`\u274C No ${v.underline("NextUI components")} found in your project. Please consult the installation guide at: https://nextui.org/docs/guide/installation#global-installation`);return}let w=[];if(g&&l.length&&w.push({level:"warn",name:"redundantDependencies",outputFn:()=>{s.log("You have installed some unnecessary dependencies. Consider removing them for optimal performance."),s.newLine(),s.log("The following dependencies are redundant:"),l.forEach(C=>{s.log(`- ${C.package}`);});}}),c&&!u.length&&w.push({level:"error",name:"missingTailwind",outputFn:()=>{s.log("Missing tailwind.config.(j|t)s file. To set up, visit: "+v.underline(Ye));}}),p&&!t&&w.push({level:"error",name:"missingApp",outputFn:()=>{s.log("App.(j|t)sx file not found. Please specify the path using: doctor --appPath=[yourAppPath]");}}),g){let[C,...d]=await ce("all",f,{allDependencies:y,packageNames:[b],peerDependencies:!0});if(l.length){let[P,...h]=await ce("partial",f,{allDependencies:y,packageNames:l.map(k=>k.package),peerDependencies:!0});C=P||C,d=[...h,...d].filter((k,$,_)=>(k=D(k).replace(/@[\d.]+/g,""),_.findIndex(H=>D(H).replace(/@[\d.]+/g,"")===k)===$));}if(C||w.push(pe("missingDependencies",{missingDependencies:d})),c)for(let P of u){let[h,...k]=le("all",P);if(!h){let $=basename(P);w.push(pe("incorrectTailwind",{errorInfo:k,tailwindName:$}));}}if(p&&t){let[P,...h]=Ne("all",t);P||w.push(pe("incorrectApp",{errorInfo:h}));}}else if(l.length){let[C,...d]=await ce("partial",f,{allDependencies:y,packageNames:l.map(P=>P.package),peerDependencies:!0});if(C||w.push(pe("missingDependencies",{missingDependencies:d})),c){let P=await J()==="pnpm";for(let h of u){let[k,...$]=le("partial",h,l,P,void 0,!0);if(!k){let _=basename(h);w.push(pe("incorrectTailwind",{errorInfo:$,tailwindName:_}));}}}if(p&&t){let[P,...h]=Ne("partial",t);P||w.push(pe("incorrectApp",{errorInfo:h}));}}if(m&&await J()==="pnpm"){let d=I(".npmrc"),[P,...h]=xe(d);P||w.push({level:"error",name:"incorrectPnpm",outputFn:()=>{s.log(`The pnpm setup is incorrect 
Please update your configuration according to the guidelines provided at: `+v.underline(Ht)),s.newLine(),s.log("Required changes:"),h.forEach(k=>{s.log(`- Add ${k}`);});}});}if(!w.length){s.newLine(),s.success("\u2705 Your project has no detected issues.");return}s.prefix("error",`\u274C Your project has ${v.underline(w.length)} issue${w.length===1?"":"s"} that require attention`),s.newLine();for(let C=0;C<w.length;C++){let d=w[C];s[d.level](`\u2757\uFE0FIssue ${C+1}: ${v.bold(d.name)}`),s.newLine(),d.outputFn(),s.newLine();}process.exit(0);}async function Rn(e){let{packagePath:t=I("package.json")}=e,{currentComponents:n}=A(t);ae({components:n}),tn(),process.exit(0);}var zo="package-lock=true";function On(e){writeFileSync(e,zo,"utf-8");}async function Xo(e){let t=await fetch(e);if(!t.body)throw new Error(`Failed to download: ${e}`);return Readable.fromWeb(t.body)}async function _n(e,t){await so(async n=>{try{await pipeline(await Xo(t),Go.x({cwd:e}));}catch(o){n(new Error(`Failed to download ${t} Error: ${o}`));}},{retries:3});}function Vn(e,t){e&&(Object.keys(Le).includes(e)||et(Object.keys(Le),e)),t&&(We.includes(t)||et(We,t));}var Le={app:$n,pages:Sn,vite:Un};async function Fn(e,t){let{package:n="npm",template:o}=t;Vn(o,n),F.intro(v.cyanBright("Create a new project"));let{packageName:r,projectName:i,template:a}=await er(n,e,o),{run:p}=ge(r);existsSync(rt(`${V}/${i}`))&&(F.cancel(`The project name ${v.redBright(i)} already exists`),process.exit(1)),a==="app"?(await yt(kn),Ct(In,i)):a==="pages"?(await yt(bn),Ct(An,i)):a==="vite"&&(await yt(Pn),Ct(vn,i));let m=rt(`${V}/${i}/.npmrc`);On(m),r==="pnpm"&&we(m,!0,!1,({message:c})=>{F.log.message(c);}),F.note(`cd ${v.cyanBright(i)}
${v.cyanBright(r)} install`,"Next steps"),F.outro(`\u{1F680} Get started with ${v.cyanBright(`${r} ${p} dev`)}`),process.exit(0);}async function yt(e){await fn({failText:"Template creation failed",successText:"Template created successfully!",task:_n(V,e),text:"Creating template..."});}function Ct(e,t){try{renameSync(join(V,e),join(V,t));}catch(n){n&&(F.cancel(`rename Error: ${n}`),process.exit(0));}}async function er(e,t,n){let o=[{hint:"A Next.js 14 with app directory template pre-configured with NextUI (v2) and Tailwind CSS.",label:v.gray("App"),value:"app"},{hint:"A Next.js 14 with pages directory template pre-configured with NextUI (v2) and Tailwind CSS.",label:v.gray("Pages"),value:"pages"},{hint:"A Vite template pre-configured with NextUI (v2) and Tailwind CSS.",label:v.gray("Vite"),value:"vite"}];return n=await Te({initialValue:n,message:"Select a template (Enter to select)",options:o}),t=await gn({initialValue:t??Le[n],message:"New project name (Enter to skip with default name)",placeholder:t??Le[n]}),e=await Te({initialValue:e,message:"Select a package manager (Enter to select)",options:[{label:v.gray("npm"),value:"npm"},{label:v.gray("yarn"),value:"yarn"},{label:v.gray("pnpm"),value:"pnpm"},{label:v.gray("bun"),value:"bun"}]}),{packageName:e,projectName:t,template:n}}async function qn(e){let{packagePath:t=I("package.json"),remote:n=!1}=e,o=x.nextUIComponents;try{if(!n){let{currentComponents:r}=await A(t);o=r;}if(!o.length){s.warn(`No NextUI components detected in the specified package.json at: ${t}`);return}n?ae({commandName:"list",components:o}):ae({components:o});}catch(r){s.prefix("error",`An error occurred while attempting to list the components: ${r}`);}process.exit(0);}async function Yn(e,t){let{remove:n}=ge(t);await ne(`${t} ${n} ${e.join(" ")}`);}async function Kn(e,t){let{currentComponents:n,isNextUIAll:o,isPnpm:r,prettier:i,tailwindPath:a}=t;if(a&&!existsSync(a)){s.prefix("warn","No tailwind.config.(j|t)s found remove action skipped");return}let p=readFileSync(a,"utf-8"),m=Y("content",p),c=Y("plugins",p),u=m.some(f=>f.includes(S.content));if(!n.length&&!o){let f=c.findIndex(l=>l.includes("nextui"));f!==-1&&c.splice(f,1),p=de("plugins",p,c),p=p.replace(/(const|var|let|import)[\W\w]+?nextui.*?;\n/,"");}if(!u){for(;m.some(f=>f.includes("nextui"));)m.splice(m.findIndex(f=>f.includes("nextui")),1);p=de("content",p,m);}writeFileSync(a,p,"utf-8");let[,...y]=le(e,a,n,r,void 0,!0);Xe(e,{errorInfoList:y,format:i,tailwindPath:a}),s.newLine(),s.info(`Remove the removed components tailwind content in file: ${a}`);}async function zn(e,t){let{all:n=!1,packagePath:o=I("package.json"),tailwindPath:r=re("**/tailwind.config.(j|t)s")[0]}=t;var{allDependencies:l,allDependenciesKeys:i,currentComponents:g}=A(o);let a=await J(),p=t.prettier??i.has("prettier"),m=!!l[b];if(!g.length&&!m){s.prefix("error",`No NextUI components detected in your package.json at: ${o}`);return}if(n||m)e=m?[b]:g.map(C=>C.package);else if(!e.length)e=await Ce("Select the components to remove",g.map(C=>({title:C.package,value:C.package})));else {if(!ye(e))return;e=Bt(e);}let c=e.includes(b)?await zt(e,l):g.filter(C=>e.some(d=>d.includes(C.package)||d.includes(C.name)));ae({components:c,message:v.yellowBright("\u2757\uFE0F Components slated for removal:")}),await me("Confirm removal of these components:",[{title:"Yes",value:!0},{title:"No",value:!1}])||process.exit(0);let y=[...e];g.filter(C=>!e.includes(C.package)).length||(l[q]&&y.push(q),l[Z]&&y.push(Z)),await Yn(y,a);var{allDependencies:l,currentComponents:g}=A(o,!1);if(m=!!l[b],Kn(m?"all":"partial",{currentComponents:g,isNextUIAll:m,isPnpm:a==="pnpm",prettier:p,tailwindPath:r}),!g.length&&!m){if(a==="pnpm"){let C=I(".npmrc");if(existsSync(C)){let d=readFileSync(C,"utf-8");d=d.replace(R.content,""),s.newLine(),s.info("Removing specified .npmrc file content"),writeFileSync(C,d,"utf-8");}}s.newLine(),s.warn(`No NextUI components remain installed. Ensure the NextUIProvider is also removed if necessary.
For more information, visit: ${Ke}`);}s.newLine(),s.success(`\u2705 Successfully removed the specified NextUI components: ${e.map(C=>v.underline(C)).join(", ")}`),process.exit(0);}async function Jn(e){if(e==="pnpm"){let t=I(".npmrc");if(!existsSync(t))writeFileSync(I(".npmrc"),R.content,"utf-8");else {let[n]=xe(t);n||we(t);}}}function Hn(e,t,n){let o=e.match(/(^\w+$)/)?.[1];if(o)return t.includes(o);let r=E(e,t);return n&&r===1&&!e.includes("beta")?!1:r>=0}async function Wn(e,t){let{all:n=!1,beta:o=!1,packagePath:r=I("package.json"),write:i=!1}=t,{allDependencies:a,currentComponents:p,dependencies:m,devDependencies:c,packageJson:u}=A(r,!1),y=!!a[b],f=[];if(await Promise.all(p.map(async d=>{let P=x.nextUIComponentsMap[d.name]?.version||await B(d.package),h=o?await Ae(d.package):P,k=Hn(d.version,h,o);f.push({...d,isLatest:k,latestVersion:h});})),!f.length&&!y){s.prefix("error",`No NextUI components detected in your package.json at: ${r}`);return}if(n)e=p.map(d=>d.package);else if(e.length){if(!ye(e))return}else {if(y){let d={isLatest:E(x.latestVersion,X(a[b]))<=0,latestVersion:x.latestVersion,package:b,version:X(a[b])};f.push(d);}f.every(d=>d.isLatest)&&(s.success("\u2705 All NextUI packages are up to date"),process.exit(0)),e=await Ce("Select the components to upgrade",f.map(d=>{let P=Hn(d.version,d.latestVersion,o);return {disabled:P,disabledMessage:"Already up to date",title:`${d.package}${P?"":`@${d.version} -> ${ie(d.version,d.latestVersion)}`}`,value:d.package}}));}e=e.map(d=>x.nextUIComponentsMap[d]?.package?x.nextUIComponentsMap[d].package:d);let l=f.filter(d=>e.includes(d.package)),g=await pn({all:n,allDependencies:a,isNextUIAll:y,upgradeOptionList:l}),w=[],C=await J();if(g.length){let d=await me("Would you like to proceed with the upgrade?",[{title:"Yes",value:!0},{description:"Select this if you wish to exclude certain packages from the upgrade",title:"No",value:!1}]),{install:P}=ge(C);d||await me("Would you like to exclude any packages from the upgrade?",[{description:"Select this to choose packages to exclude",title:"Yes",value:!0},{description:"Select this to proceed without excluding any packages",title:"No",value:!1}])&&(w=await yn("Select the packages you want to exclude from the upgrade:",g.map(k=>({description:`${k.version} -> ${ie(k.version,k.latestVersion)}`,title:k.package,value:k.package})))),g=g.filter(h=>!w.some(k=>h.package===k)),i?(cn({dependencies:m,devDependencies:c,upgradePackageList:g}),cr.writeFileSync(r,JSON.stringify(u,null,2),"utf-8"),s.newLine(),s.success("\u2705 Upgrade version written to package.json"),process.exit(0)):await He(()=>ne(`${C} ${P} ${g.reduce((h,k,$)=>`${h}${$===0?"":" "}${k.package}@${k.latestVersion.replace(M,"")}`,"")}`));}Jn(C),s.newLine(),s.success("\u2705 Upgrade complete. All components are up to date."),process.exit(0);}var wt=["add","env","init","list","upgrade","doctor","remove"],K=new Command;K.name("nextui").usage("[command]").description(qt(`
NextUI CLI v${Je.version}
`,"")).version(Je.version,"-v, --version","Output the current version").helpOption("-h, --help","Display help for command").allowUnknownOption().option("--no-cache","Disable cache, by default data will be cached for 30m after the first request").option("-d, --debug","Debug mode will not install dependencies").action(async(e,t)=>{let n=!1;if(t){let o=t.args?.[0];if(o&&!wt.includes(o)){n=!0;let r=Pe(wt,o);r?s.error(`Unknown command '${o}', Did you mean '${v.underline(r)}'?`):s.error(`Unknown command '${o}'`);}}if(!n){let r=(await z("nextui --help")).split(`
`);r=r.filter(i=>i&&!i.includes("NextUI CLI v")),r=r.map(i=>{let a=i.match(/(\w+)\s\[/)?.[1];return a?i.replace(a,v.cyan(a)):i}),s.log(r.join(`
`));}process.exit(0);});K.command("init").description("Initializes a new project").argument("[projectName]","Name of the project to initialize").option("-t --template [string]","Specify a template for the new project, e.g., app, pages").option("-p --package [string]","The package manager to use for the new project","npm").action(Fn);K.command("add").description("Adds components to your project").argument("[components...]","Names of components to add").option("-a --all [boolean]","Add all components",!1).option("-p --packagePath [string]","Specify the path to the package.json file").option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("-app --appPath [string]","Specify the path to the App.tsx file").option("--prettier [boolean]","Apply Prettier formatting to the added content").option("--addApp [boolean]","Include App.tsx file content that requires a provider",!1).option("-b --beta [boolean]","Add beta components",!1).action(En);K.command("upgrade").description("Upgrades project components to the latest versions").argument("[components...]","Names of components to upgrade").option("-p --packagePath [string]","Specify the path to the package.json file").option("-a --all [boolean]","Upgrade all components",!1).option("-w --write [boolean]","Write the upgrade version to package.json file",!1).option("-b --beta [boolean]","Upgrade beta components",!1).action(Wn);K.command("remove").description("Removes components from the project").argument("[components...]","Names of components to remove").option("-p --packagePath [string]","Specify the path to the package.json file").option("-a --all [boolean]","Remove all components",!1).option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("--prettier [boolean]","Apply Prettier formatting to the added content").action(zn);K.command("list").description("Lists all components, showing status, descriptions, and versions").option("-p --packagePath [string]","Specify the path to the package.json file").option("-r --remote","List all components available remotely").action(qn);K.command("env").description("Displays debugging information for the local environment").option("-p --packagePath [string]","Specify the path to the package.json file").action(Rn);K.command("doctor").description("Checks for issues in the project").option("-p --packagePath [string]","Specify the path to the package.json file").option("-tw --tailwindPath [string]","Specify the path to the tailwind.config.js file").option("-app --appPath [string]","Specify the path to the App.tsx file").option("-ca --checkApp [boolean]","Check the App.tsx file",!1).option("-ct --checkTailwind [boolean]","Check the tailwind.config.js file",!0).option("-cp --checkPnpm [boolean]","Check for Pnpm",!0).action(Mn);K.hook("preAction",async e=>{let t=e.args?.[0],n=e.rawArgs.slice(2),o=n.includes("--no-cache"),r=n.includes("--debug")||n.includes("-d");if(st(o),x.debug=r,x.beta=n.includes("-b")||n.includes("--beta"),t&&wt.includes(t)){let m=(await nt()).components,c=(await nt()).betaComponents;ct({beta:!1,nextUIComponents:m}),x.beta&&ct({beta:!0,nextUIComponents:c});}let[i,a]=await Promise.all([G("cliLatestVersion"),G("latestVersion")]);x.latestVersion=a,x.cliLatestVersion=i;let p=Je.version;E(p,i)===-1&&(fe({center:!0,color:"yellow",padding:1,text:`${v.gray(`Available upgrade: v${p} -> ${v.greenBright(`v${i}`)}
Run \`${v.cyan("npm install -g nextui-cli@latest")}\` to upgrade
Changelog: ${v.underline("https://github.com/nextui-org/nextui-cli/releases")}`)}`,title:Ze("NextUI CLI")}),s.newLine()),nn();});K.parseAsync(process.argv).catch(async e=>{s.newLine(),s.error("Unexpected error. Please report it as a bug:"),s.log(e),s.newLine(),process.exit(1);});
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.js.map