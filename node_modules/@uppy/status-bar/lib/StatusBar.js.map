{"version":3,"names":["UIPlugin","emaFilter","getTextDirection","statusBarStates","StatusBarUI","packageJson","locale","speedFilterHalfLife","ETAFilterHalfLife","getUploadingState","error","isAllComplete","recoveredState","files","STATE_ERROR","STATE_COMPLETE","STATE_WAITING","state","fileIDs","Object","keys","i","length","progress","uploadStarted","uploadComplete","STATE_UPLOADING","preprocess","STATE_PREPROCESSING","postprocess","STATE_POSTPROCESSING","defaultOptions","hideUploadButton","hideRetryButton","hidePauseResumeButton","hideCancelButton","showProgressDetails","hideAfterFinish","doneButtonHandler","_lastUpdateTime","_classPrivateFieldLooseKey","_previousUploadedBytes","_previousSpeed","_previousETA","_computeSmoothETA","_onUploadStart","StatusBar","constructor","uppy","opts","defineProperty","value","_computeSmoothETA2","writable","startUpload","upload","catch","getState","_classPrivateFieldLooseBase","values","reduce","pv","_ref","bytesUploaded","emit","performance","now","id","title","type","defaultLocale","i18nInit","render","bind","install","capabilities","allowNewUpload","totalProgress","newFiles","startedFiles","completeFiles","isUploadStarted","isAllPaused","isUploadInProgress","isSomeGhost","getObjectOfFilesPerState","newFilesOrRecovered","resumableUploads","supportsUploadProgress","uploadProgress","totalSize","totalUploadedSize","every","f","bytesTotal","forEach","file","totalETA","uploaded","total","uploadState","complete","numUploads","i18n","onMount","element","el","direction","dir","target","mount","on","getFiles","uninstall","unmount","off","totalBytes","_classPrivateFieldLoo","_classPrivateFieldLoo2","remaining","dt","_classPrivateFieldLoo3","Math","round","uploadedBytesSinceLastTick","_classPrivateFieldLoo4","currentSpeed","filteredSpeed","instantETA","updatedPreviousETA","max","filteredETA","VERSION","version"],"sources":["StatusBar.tsx"],"sourcesContent":["import type { ComponentChild } from 'preact'\nimport type {\n  Body,\n  Meta,\n  UppyFile,\n  DefinePluginOpts,\n  Uppy,\n  State,\n} from '@uppy/core'\nimport { UIPlugin } from '@uppy/core'\nimport emaFilter from '@uppy/utils/lib/emaFilter'\nimport getTextDirection from '@uppy/utils/lib/getTextDirection'\nimport statusBarStates from './StatusBarStates.js'\nimport StatusBarUI, { type StatusBarUIProps } from './StatusBarUI.jsx'\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nimport packageJson from '../package.json'\nimport locale from './locale.js'\nimport type { StatusBarOptions } from './StatusBarOptions.js'\n\nconst speedFilterHalfLife = 2000\nconst ETAFilterHalfLife = 2000\n\nfunction getUploadingState(\n  error: unknown,\n  isAllComplete: boolean,\n  recoveredState: any,\n  files: Record<string, UppyFile<any, any>>,\n): StatusBarUIProps<any, any>['uploadState'] {\n  if (error) {\n    return statusBarStates.STATE_ERROR\n  }\n\n  if (isAllComplete) {\n    return statusBarStates.STATE_COMPLETE\n  }\n\n  if (recoveredState) {\n    return statusBarStates.STATE_WAITING\n  }\n\n  let state: StatusBarUIProps<any, any>['uploadState'] =\n    statusBarStates.STATE_WAITING\n  const fileIDs = Object.keys(files)\n  for (let i = 0; i < fileIDs.length; i++) {\n    const { progress } = files[fileIDs[i]]\n    // If ANY files are being uploaded right now, show the uploading state.\n    if (progress.uploadStarted && !progress.uploadComplete) {\n      return statusBarStates.STATE_UPLOADING\n    }\n    // If files are being preprocessed AND postprocessed at this time, we show the\n    // preprocess state. If any files are being uploaded we show uploading.\n    if (progress.preprocess) {\n      state = statusBarStates.STATE_PREPROCESSING\n    }\n    // If NO files are being preprocessed or uploaded right now, but some files are\n    // being postprocessed, show the postprocess state.\n    if (progress.postprocess && state !== statusBarStates.STATE_PREPROCESSING) {\n      state = statusBarStates.STATE_POSTPROCESSING\n    }\n  }\n  return state\n}\n\nconst defaultOptions = {\n  hideUploadButton: false,\n  hideRetryButton: false,\n  hidePauseResumeButton: false,\n  hideCancelButton: false,\n  showProgressDetails: false,\n  hideAfterFinish: true,\n  doneButtonHandler: null,\n} satisfies StatusBarOptions\n\n/**\n * StatusBar: renders a status bar with upload/pause/resume/cancel/retry buttons,\n * progress percentage and time remaining.\n */\nexport default class StatusBar<M extends Meta, B extends Body> extends UIPlugin<\n  DefinePluginOpts<StatusBarOptions, keyof typeof defaultOptions>,\n  M,\n  B\n> {\n  static VERSION = packageJson.version\n\n  #lastUpdateTime!: ReturnType<typeof performance.now>\n\n  #previousUploadedBytes!: number | null\n\n  #previousSpeed!: number | null\n\n  #previousETA!: number | null\n\n  constructor(uppy: Uppy<M, B>, opts?: StatusBarOptions) {\n    super(uppy, { ...defaultOptions, ...opts })\n    this.id = this.opts.id || 'StatusBar'\n    this.title = 'StatusBar'\n    this.type = 'progressindicator'\n\n    this.defaultLocale = locale\n\n    this.i18nInit()\n\n    this.render = this.render.bind(this)\n    this.install = this.install.bind(this)\n  }\n\n  #computeSmoothETA(totalBytes: {\n    uploaded: number\n    total: number | null // null means indeterminate\n  }) {\n    if (totalBytes.total == null || totalBytes.total === 0) {\n      return null\n    }\n\n    const remaining = totalBytes.total - totalBytes.uploaded\n    if (remaining <= 0) {\n      return null\n    }\n\n    // When state is restored, lastUpdateTime is still nullish at this point.\n    this.#lastUpdateTime ??= performance.now()\n    const dt = performance.now() - this.#lastUpdateTime\n    if (dt === 0) {\n      return Math.round((this.#previousETA ?? 0) / 100) / 10\n    }\n\n    const uploadedBytesSinceLastTick =\n      totalBytes.uploaded - this.#previousUploadedBytes!\n    this.#previousUploadedBytes = totalBytes.uploaded\n\n    // uploadedBytesSinceLastTick can be negative in some cases (packet loss?)\n    // in which case, we wait for next tick to update ETA.\n    if (uploadedBytesSinceLastTick <= 0) {\n      return Math.round((this.#previousETA ?? 0) / 100) / 10\n    }\n    const currentSpeed = uploadedBytesSinceLastTick / dt\n    const filteredSpeed =\n      this.#previousSpeed == null ?\n        currentSpeed\n      : emaFilter(currentSpeed, this.#previousSpeed, speedFilterHalfLife, dt)\n    this.#previousSpeed = filteredSpeed\n    const instantETA = remaining / filteredSpeed\n\n    const updatedPreviousETA = Math.max(this.#previousETA! - dt, 0)\n    const filteredETA =\n      this.#previousETA == null ?\n        instantETA\n      : emaFilter(instantETA, updatedPreviousETA, ETAFilterHalfLife, dt)\n    this.#previousETA = filteredETA\n    this.#lastUpdateTime = performance.now()\n\n    return Math.round(filteredETA / 100) / 10\n  }\n\n  startUpload = (): ReturnType<Uppy<M, B>['upload']> => {\n    return this.uppy.upload().catch((() => {\n      // Error logged in Core\n    }) as () => undefined)\n  }\n\n  render(state: State<M, B>): ComponentChild {\n    const {\n      capabilities,\n      files,\n      allowNewUpload,\n      totalProgress,\n      error,\n      recoveredState,\n    } = state\n\n    const {\n      newFiles,\n      startedFiles,\n      completeFiles,\n\n      isUploadStarted,\n      isAllComplete,\n      isAllPaused,\n      isUploadInProgress,\n      isSomeGhost,\n    } = this.uppy.getObjectOfFilesPerState()\n\n    // If some state was recovered, we want to show Upload button/counter\n    // for all the files, because in this case it’s not an Upload button,\n    // but “Confirm Restore Button”\n    const newFilesOrRecovered = recoveredState ? Object.values(files) : newFiles\n    const resumableUploads = !!capabilities.resumableUploads\n    const supportsUploadProgress = capabilities.uploadProgress !== false\n\n    let totalSize: number | null = null\n    let totalUploadedSize = 0\n\n    // Only if all files have a known size, does it make sense to display a total size\n    if (\n      startedFiles.every(\n        (f) => f.progress.bytesTotal != null && f.progress.bytesTotal !== 0,\n      )\n    ) {\n      totalSize = 0\n      startedFiles.forEach((file) => {\n        totalSize! += file.progress.bytesTotal || 0\n        totalUploadedSize += file.progress.bytesUploaded || 0\n      })\n    } else {\n      // however uploaded size we will always have\n      startedFiles.forEach((file) => {\n        totalUploadedSize += file.progress.bytesUploaded || 0\n      })\n    }\n\n    const totalETA = this.#computeSmoothETA({\n      uploaded: totalUploadedSize,\n      total: totalSize,\n    })\n\n    return StatusBarUI({\n      error,\n      uploadState: getUploadingState(\n        error,\n        isAllComplete,\n        recoveredState,\n        state.files || {},\n      ),\n      allowNewUpload,\n      totalProgress,\n      totalSize,\n      totalUploadedSize,\n      isAllComplete: false,\n      isAllPaused,\n      isUploadStarted,\n      isUploadInProgress,\n      isSomeGhost,\n      recoveredState,\n      complete: completeFiles.length,\n      newFiles: newFilesOrRecovered.length,\n      numUploads: startedFiles.length,\n      totalETA,\n      files,\n      i18n: this.i18n,\n      uppy: this.uppy,\n      startUpload: this.startUpload,\n      doneButtonHandler: this.opts.doneButtonHandler,\n      resumableUploads,\n      supportsUploadProgress,\n      showProgressDetails: this.opts.showProgressDetails,\n      hideUploadButton: this.opts.hideUploadButton,\n      hideRetryButton: this.opts.hideRetryButton,\n      hidePauseResumeButton: this.opts.hidePauseResumeButton,\n      hideCancelButton: this.opts.hideCancelButton,\n      hideAfterFinish: this.opts.hideAfterFinish,\n    })\n  }\n\n  onMount(): void {\n    // Set the text direction if the page has not defined one.\n    const element = this.el!\n    const direction = getTextDirection(element)\n    if (!direction) {\n      element.dir = 'ltr'\n    }\n  }\n\n  #onUploadStart = (): void => {\n    const { recoveredState } = this.uppy.getState()\n\n    this.#previousSpeed = null\n    this.#previousETA = null\n    if (recoveredState) {\n      this.#previousUploadedBytes = Object.values(recoveredState.files).reduce(\n        (pv, { progress }) => pv + (progress.bytesUploaded as number),\n        0,\n      )\n\n      // We don't set `#lastUpdateTime` at this point because the upload won't\n      // actually resume until the user asks for it.\n\n      this.uppy.emit('restore-confirmed')\n      return\n    }\n    this.#lastUpdateTime = performance.now()\n    this.#previousUploadedBytes = 0\n  }\n\n  install(): void {\n    const { target } = this.opts\n    if (target) {\n      this.mount(target, this)\n    }\n    this.uppy.on('upload', this.#onUploadStart)\n\n    // To cover the use case where the status bar is installed while the upload\n    // has started, we set `lastUpdateTime` right away.\n    this.#lastUpdateTime = performance.now()\n    this.#previousUploadedBytes = this.uppy\n      .getFiles()\n      .reduce((pv, file) => pv + (file.progress.bytesUploaded as number), 0)\n  }\n\n  uninstall(): void {\n    this.unmount()\n    this.uppy.off('upload', this.#onUploadStart)\n  }\n}\n"],"mappings":"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","ignoreList":[]}