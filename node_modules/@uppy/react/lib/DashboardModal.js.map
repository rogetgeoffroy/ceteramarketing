{"version":3,"names":["createElement","h","Component","DashboardPlugin","getHTMLProps","nonHtmlPropsHaveChanged","DashboardModal","componentDidMount","installPlugin","componentDidUpdate","prevProps","uppy","open","onRequestClose","props","uninstallPlugin","options","inline","onRequestCloseModal","plugin","setOptions","closeModal","openModal","componentWillUnmount","target","container","rest","id","use","getPlugin","removePlugin","render","className","ref","defaultProps","undefined"],"sources":["DashboardModal.ts"],"sourcesContent":["import { createElement as h, Component } from 'react'\nimport type React from 'react'\nimport DashboardPlugin, { type DashboardOptions } from '@uppy/dashboard'\nimport type { Body, Meta, Uppy } from '@uppy/core'\nimport getHTMLProps from './getHTMLProps.js'\nimport nonHtmlPropsHaveChanged from './nonHtmlPropsHaveChanged.js'\n\ntype DashboardInlineOptions<M extends Meta, B extends Body> = Omit<\n  DashboardOptions<M, B> & { inline: false },\n  'inline' | 'onRequestCloseModal'\n> &\n  React.BaseHTMLAttributes<HTMLDivElement>\n\nexport interface DashboardModalProps<M extends Meta, B extends Body>\n  extends DashboardInlineOptions<M, B> {\n  uppy: Uppy<M, B>\n  onRequestClose?: () => void\n  open?: boolean\n}\n\n/**\n * React Component that renders a Dashboard for an Uppy instance in a Modal\n * dialog. Visibility of the Modal is toggled using the `open` prop.\n */\n\nclass DashboardModal<M extends Meta, B extends Body> extends Component<\n  DashboardModalProps<M, B>\n> {\n  static defaultProps = {\n    open: undefined,\n    onRequestClose: undefined,\n  }\n\n  private container!: HTMLElement\n\n  private plugin!: DashboardPlugin<M, B>\n\n  componentDidMount(): void {\n    this.installPlugin()\n  }\n\n  componentDidUpdate(prevProps: DashboardModal<M, B>['props']): void {\n    const { uppy, open, onRequestClose } = this.props\n    if (prevProps.uppy !== uppy) {\n      this.uninstallPlugin(prevProps)\n      this.installPlugin()\n    } else if (nonHtmlPropsHaveChanged(this.props, prevProps)) {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars,no-shadow\n      const { uppy, ...options } = {\n        ...this.props,\n        inline: false,\n        onRequestCloseModal: onRequestClose,\n      }\n      this.plugin.setOptions(options)\n    }\n    if (prevProps.open && !open) {\n      this.plugin.closeModal()\n    } else if (!prevProps.open && open) {\n      this.plugin.openModal()\n    }\n  }\n\n  componentWillUnmount(): void {\n    this.uninstallPlugin()\n  }\n\n  installPlugin(): void {\n    const {\n      target = this.container,\n      open,\n      onRequestClose,\n      uppy,\n      ...rest\n    } = this.props\n    const options = {\n      id: 'DashboardModal',\n      ...rest,\n      inline: false,\n      target,\n      open,\n      onRequestCloseModal: onRequestClose,\n    }\n\n    uppy.use(DashboardPlugin<M, B>, options)\n\n    this.plugin = uppy.getPlugin(options.id) as DashboardPlugin<M, B>\n    if (open) {\n      this.plugin.openModal()\n    }\n  }\n\n  uninstallPlugin(props = this.props): void {\n    const { uppy } = props\n\n    uppy.removePlugin(this.plugin)\n  }\n\n  // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n  render() {\n    return h('div', {\n      className: 'uppy-Container',\n      ref: (container: HTMLElement) => {\n        this.container = container\n      },\n      ...getHTMLProps(this.props),\n    })\n  }\n}\n\nexport default DashboardModal\n"],"mappings":"AAAA,SAASA,aAAa,IAAIC,CAAC,EAAEC,SAAS,QAAQ,OAAO;AAErD,OAAOC,eAAe,MAAiC,iBAAiB;AAExE,OAAOC,YAAY,MAAM,mBAAmB;AAC5C,OAAOC,uBAAuB,MAAM,8BAA8B;AAelE;AACA;AACA;AACA;;AAEA,MAAMC,cAAc,SAAyCJ,SAAS,CAEpE;EAUAK,iBAAiBA,CAAA,EAAS;IACxB,IAAI,CAACC,aAAa,CAAC,CAAC;EACtB;EAEAC,kBAAkBA,CAACC,SAAwC,EAAQ;IACjE,MAAM;MAAEC,IAAI;MAAEC,IAAI;MAAEC;IAAe,CAAC,GAAG,IAAI,CAACC,KAAK;IACjD,IAAIJ,SAAS,CAACC,IAAI,KAAKA,IAAI,EAAE;MAC3B,IAAI,CAACI,eAAe,CAACL,SAAS,CAAC;MAC/B,IAAI,CAACF,aAAa,CAAC,CAAC;IACtB,CAAC,MAAM,IAAIH,uBAAuB,CAAC,IAAI,CAACS,KAAK,EAAEJ,SAAS,CAAC,EAAE;MACzD;MACA,MAAM;QAAEC,IAAI;QAAE,GAAGK;MAAQ,CAAC,GAAG;QAC3B,GAAG,IAAI,CAACF,KAAK;QACbG,MAAM,EAAE,KAAK;QACbC,mBAAmB,EAAEL;MACvB,CAAC;MACD,IAAI,CAACM,MAAM,CAACC,UAAU,CAACJ,OAAO,CAAC;IACjC;IACA,IAAIN,SAAS,CAACE,IAAI,IAAI,CAACA,IAAI,EAAE;MAC3B,IAAI,CAACO,MAAM,CAACE,UAAU,CAAC,CAAC;IAC1B,CAAC,MAAM,IAAI,CAACX,SAAS,CAACE,IAAI,IAAIA,IAAI,EAAE;MAClC,IAAI,CAACO,MAAM,CAACG,SAAS,CAAC,CAAC;IACzB;EACF;EAEAC,oBAAoBA,CAAA,EAAS;IAC3B,IAAI,CAACR,eAAe,CAAC,CAAC;EACxB;EAEAP,aAAaA,CAAA,EAAS;IACpB,MAAM;MACJgB,MAAM,GAAG,IAAI,CAACC,SAAS;MACvBb,IAAI;MACJC,cAAc;MACdF,IAAI;MACJ,GAAGe;IACL,CAAC,GAAG,IAAI,CAACZ,KAAK;IACd,MAAME,OAAO,GAAG;MACdW,EAAE,EAAE,gBAAgB;MACpB,GAAGD,IAAI;MACPT,MAAM,EAAE,KAAK;MACbO,MAAM;MACNZ,IAAI;MACJM,mBAAmB,EAAEL;IACvB,CAAC;IAEDF,IAAI,CAACiB,GAAG,CAACzB,eAAe,EAAQa,OAAO,CAAC;IAExC,IAAI,CAACG,MAAM,GAAGR,IAAI,CAACkB,SAAS,CAACb,OAAO,CAACW,EAAE,CAA0B;IACjE,IAAIf,IAAI,EAAE;MACR,IAAI,CAACO,MAAM,CAACG,SAAS,CAAC,CAAC;IACzB;EACF;EAEAP,eAAeA,CAACD,KAAK,EAAqB;IAAA,IAA1BA,KAAK;MAALA,KAAK,GAAG,IAAI,CAACA,KAAK;IAAA;IAChC,MAAM;MAAEH;IAAK,CAAC,GAAGG,KAAK;IAEtBH,IAAI,CAACmB,YAAY,CAAC,IAAI,CAACX,MAAM,CAAC;EAChC;;EAEA;EACAY,MAAMA,CAAA,EAAG;IACP,OAAO9B,CAAC,CAAC,KAAK,EAAE;MACd+B,SAAS,EAAE,gBAAgB;MAC3BC,GAAG,EAAGR,SAAsB,IAAK;QAC/B,IAAI,CAACA,SAAS,GAAGA,SAAS;MAC5B,CAAC;MACD,GAAGrB,YAAY,CAAC,IAAI,CAACU,KAAK;IAC5B,CAAC,CAAC;EACJ;AACF;AAlFMR,cAAc,CAGX4B,YAAY,GAAG;EACpBtB,IAAI,EAAEuB,SAAS;EACftB,cAAc,EAAEsB;AAClB,CAAC;AA8EH,eAAe7B,cAAc","ignoreList":[]}